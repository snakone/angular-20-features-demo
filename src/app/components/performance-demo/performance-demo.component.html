<div class="performance-demo">
  <div class="demo-header">
    <h1>Angular 20 Performance Demo</h1>
    <p>Latest performance improvements, optimizations, and monitoring</p>
    <a routerLink="/" class="back-link">‚Üê Back to Home</a>
  </div>

  <div class="demo-sections">
    <!-- Performance Overview Section -->
    <section class="demo-section">
      <h2>Performance Overview</h2>
      <div class="info-box">
        <p>Angular 20 introduces significant performance improvements including zoneless change detection, optimized signals, and enhanced SSR capabilities.</p>
        <div class="benefits">
          <h4>Key Improvements:</h4>
          <ul>
            <li>üöÄ <strong>Zoneless Mode:</strong> Eliminates zone.js overhead for better performance</li>
            <li>‚ö° <strong>Optimized Signals:</strong> Faster change detection with signals</li>
            <li>üì¶ <strong>Tree Shaking:</strong> Smaller bundle sizes with better dead code elimination</li>
            <li>üåê <strong>Enhanced SSR:</strong> Faster server-side rendering and hydration</li>
            <li>üíæ <strong>Memory Optimization:</strong> Reduced memory footprint and better garbage collection</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Real-time Performance Metrics -->
    <section class="demo-section">
      <h2>Real-time Performance Metrics</h2>
      <div class="metrics-grid">
        <div class="metric-card">
          <h3>Render Performance</h3>
          <div class="metric-value">{{ averageRenderTime() | number:'1.2-2' }}ms</div>
          <div class="metric-label">Average Render Time</div>
          <div class="performance-grade" [class]="'grade-' + getPerformanceGrade().toLowerCase().replace('+', '-plus')">
            {{ getPerformanceGrade() }}
          </div>
        </div>
        
        <div class="metric-card">
          <h3>Memory Usage</h3>
          <div class="metric-value">{{ memoryUsage() | number:'1.0-0' }}MB</div>
          <div class="metric-label">Current Memory</div>
          <div class="performance-grade" [class]="'grade-' + getMemoryGrade().toLowerCase().replace('+', '-plus')">
            {{ getMemoryGrade() }}
          </div>
        </div>
        
        <div class="metric-card">
          <h3>Bundle Size</h3>
          <div class="metric-value">{{ bundleSize() | number:'1.2-2' }}KB</div>
          <div class="metric-label">Application Bundle</div>
          <div class="optimization-status" [class]="treeShakingEnabled() ? 'enabled' : 'disabled'">
            {{ treeShakingEnabled() ? 'Optimized' : 'Unoptimized' }}
          </div>
        </div>
        
        <div class="metric-card">
          <h3>Change Detection</h3>
          <div class="metric-value">{{ changeDetectionCycles() }}</div>
          <div class="metric-label">Detection Cycles</div>
          <div class="zoneless-status" [class]="zonelessEnabled() ? 'enabled' : 'disabled'">
            {{ zonelessEnabled() ? 'Zoneless' : 'Zone.js' }}
          </div>
        </div>
      </div>
    </section>

    <!-- Zoneless Performance Demo -->
    <section class="demo-section">
      <h2>Zoneless Performance</h2>
      <div class="performance-example">
        <h3>Change Detection Comparison</h3>
        <p>Compare the performance difference between zoneless and zone.js change detection.</p>
        
        <div class="zoneless-controls">
          <button (click)="toggleZoneless()" class="btn" [class]="zonelessEnabled() ? 'btn-success' : 'btn-warning'">
            {{ zonelessEnabled() ? 'Zoneless Enabled' : 'Zone.js Enabled' }}
          </button>
          <button (click)="triggerSignalUpdate()" class="btn btn-primary">Single Update</button>
          <button (click)="triggerMultipleUpdates()" class="btn btn-secondary">100 Updates</button>
        </div>

        <div class="performance-stats">
          <div class="stat-item">
            <span class="stat-label">Signal Count:</span>
            <span class="stat-value">{{ signalCount() }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Computed Value:</span>
            <span class="stat-value">{{ computedValue() }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Last Render Time:</span>
            <span class="stat-value">{{ lastRenderTime() | number:'1.3-3' }}ms</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Bundle Optimization -->
    <section class="demo-section">
      <h2>Bundle Optimization</h2>
      <div class="performance-example">
        <h3>Tree Shaking Impact</h3>
        <p>See how tree shaking affects your application bundle size.</p>
        
        <div class="bundle-controls">
          <button (click)="enableTreeShaking()" class="btn" [class]="treeShakingEnabled() ? 'btn-success' : 'btn-secondary'">
            Enable Tree Shaking
          </button>
          <button (click)="disableTreeShaking()" class="btn" [class]="!treeShakingEnabled() ? 'btn-warning' : 'btn-secondary'">
            Disable Tree Shaking
          </button>
        </div>

        <div class="bundle-comparison">
          <div class="bundle-size">
            <h4>Current Bundle Size</h4>
            <div class="size-display">{{ bundleSize() | number:'1.2-2' }} KB</div>
            <div class="size-impact" [class]="treeShakingEnabled() ? 'positive' : 'negative'">
              {{ treeShakingEnabled() ? 'Optimized' : 'Unoptimized' }}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SSR Performance -->
    <section class="demo-section">
      <h2>Server-Side Rendering</h2>
      <div class="performance-example">
        <h3>Hydration Performance</h3>
        <p>Test the performance of server-side rendering and client-side hydration.</p>
        
        <div class="ssr-controls">
          <button (click)="toggleSSR()" class="btn" [class]="ssrEnabled() ? 'btn-success' : 'btn-secondary'">
            {{ ssrEnabled() ? 'SSR Enabled' : 'SSR Disabled' }}
          </button>
          <button (click)="simulateHydration()" class="btn btn-primary">Simulate Hydration</button>
        </div>

        @if (hydrationTime() > 0) {
          <div class="hydration-results">
            <h4>Hydration Performance</h4>
            <div class="hydration-time">{{ hydrationTime() | number:'1.2-2' }}ms</div>
            <div class="hydration-grade" [class]="hydrationTime() < 100 ? 'excellent' : hydrationTime() < 500 ? 'good' : 'poor'">
              {{ hydrationTime() < 100 ? 'Excellent' : hydrationTime() < 500 ? 'Good' : 'Needs Improvement' }}
            </div>
          </div>
        }
      </div>
    </section>

    <!-- Core Web Vitals -->
    <section class="demo-section">
      <h2>Core Web Vitals</h2>
      <div class="performance-example">
        <h3>Web Performance Metrics</h3>
        <p>Monitor key web performance indicators that affect user experience.</p>
        
        <div class="web-vitals">
          <div class="vital-metric">
            <h4>First Contentful Paint (FCP)</h4>
            <div class="vital-value">{{ performanceMetrics().fcp | number:'1.0-0' }}ms</div>
            <div class="vital-grade" [class]="performanceMetrics().fcp < 1800 ? 'good' : 'poor'">
              {{ performanceMetrics().fcp < 1800 ? 'Good' : 'Poor' }}
            </div>
          </div>
          
          <div class="vital-metric">
            <h4>Largest Contentful Paint (LCP)</h4>
            <div class="vital-value">{{ performanceMetrics().lcp | number:'1.0-0' }}ms</div>
            <div class="vital-grade" [class]="performanceMetrics().lcp < 2500 ? 'good' : 'poor'">
              {{ performanceMetrics().lcp < 2500 ? 'Good' : 'Poor' }}
            </div>
          </div>
          
          <div class="vital-metric">
            <h4>First Input Delay (FID)</h4>
            <div class="vital-value">{{ performanceMetrics().fid | number:'1.0-0' }}ms</div>
            <div class="vital-grade" [class]="performanceMetrics().fid < 100 ? 'good' : 'poor'">
              {{ performanceMetrics().fid < 100 ? 'Good' : 'Poor' }}
            </div>
          </div>
          
          <div class="vital-metric">
            <h4>Cumulative Layout Shift (CLS)</h4>
            <div class="vital-value">{{ performanceMetrics().cls | number:'1.3-3' }}</div>
            <div class="vital-grade" [class]="performanceMetrics().cls < 0.1 ? 'good' : 'poor'">
              {{ performanceMetrics().cls < 0.1 ? 'Good' : 'Poor' }}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Performance Tips -->
    <section class="demo-section">
      <h2>Performance Optimization Tips</h2>
      <div class="optimization-tips">
        <div class="tip-item">
          <h4>üéØ Use Signals</h4>
          <p>Signals provide more efficient change detection than traditional reactive patterns.</p>
        </div>
        <div class="tip-item">
          <h4>üö´ Enable Zoneless</h4>
          <p>Remove zone.js to eliminate overhead and improve performance.</p>
        </div>
        <div class="tip-item">
          <h4>üì¶ Optimize Bundles</h4>
          <p>Use tree shaking and code splitting to reduce bundle sizes.</p>
        </div>
        <div class="tip-item">
          <h4>üåê Enable SSR</h4>
          <p>Use server-side rendering for faster initial page loads.</p>
        </div>
        <div class="tip-item">
          <h4>üíæ Monitor Memory</h4>
          <p>Keep track of memory usage and avoid memory leaks.</p>
        </div>
        <div class="tip-item">
          <h4>‚ö° Lazy Load</h4>
          <p>Use &#64;defer to lazy load components and improve initial performance.</p>
        </div>
      </div>
    </section>

    <!-- Reset Section -->
    <section class="demo-section">
      <h2>Reset Performance Metrics</h2>
      <div class="reset-section">
        <p>Click the button below to reset all performance metrics and start fresh monitoring.</p>
        <button (click)="resetMetrics()" class="btn btn-danger">Reset All Metrics</button>
      </div>
    </section>
  </div>

  <div class="demo-footer">
    <h3>Key Features Demonstrated:</h3>
    <ul>
      <li><strong>Zoneless Performance:</strong> Faster change detection without zone.js</li>
      <li><strong>Signal Optimization:</strong> Efficient reactive state management</li>
      <li><strong>Bundle Optimization:</strong> Tree shaking and code splitting</li>
      <li><strong>SSR Performance:</strong> Server-side rendering and hydration</li>
      <li><strong>Memory Monitoring:</strong> Real-time memory usage tracking</li>
      <li><strong>Web Vitals:</strong> Core web performance metrics</li>
    </ul>
  </div>
</div>
